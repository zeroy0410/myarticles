---
title: tarjan求强联通分量
date: 2018-08-30 13:26:53
tags: 模板集合
---

#### tarjan算法简介
>强连通分量（英语：Strongly connected component）是图论中的概念。图论中，强连通图指每一个顶点皆可以经由该图上的边抵达其他的每一个点的有向图。意即对于此图上每一个点对(Va,Vb)，皆存在路径Va→Vb以及Vb→Va。强连通分量则是指一张有向图G的极大强连通子图G'。如果将每一个强连通分量缩成一个点，则原图G将会变成一张有向无环图。一张图被称为有向无环图当且仅当此图不具有点集合数量大于一的强连通分量，因为有向环即是一个强连通分量，而且任何的强连通分量皆具有至少一个有向环。(摘自维基百科)

算法流程如下：
>此算法以一个有向图作为输入，并按照所在的强连通分量给出其顶点集的一个划分。图中的每个节点只在一个强连通分量中出现，即使是在有些节点单独构成一个强连通分量的情况下（比如图中出现了树形结构或孤立节点）。

<!--more-->
算法的基本思想如下：
>任选一节点开始进行深度优先搜索（若深度优先搜索结束后仍有未访问的节点，则再从中任选一点再次进行）。搜索过程中已访问的节点不再访问。搜索树的若干子树构成了图的强连通分量。
节点按照被访问的顺序存入堆栈中。从搜索树的子树返回至一个节点时，检查该节点是否是某一强连通分量的根节点（见下）并将其从堆栈中删除。如果某节点是强连通分量的根，则在它之前出堆栈且还不属于其他强连通分量的节点构成了该节点所在的强连通分量。

关于此算法的正确性证明，byvoid天牛的博客上已经做了非常详细的说明，在此直接放上[链接](https://www.byvoid.com/zhs/blog/scc-tarjan)

#### 代码
```c++
void tarjan(int x){
	dfn[x]=low[x]=++tt;
	stk[++top]=x;
	vis[x]=1;
	for(int i=0;i<G[x].size();i++){
		int u=G[x][i];
		if(!dfn[u]){
			tarjan(u);
			low[x]=min(low[x],low[u]);
		}else if(vis[u]){
			low[x]=min(low[x],dfn[u]);
		}
	}
	if(dfn[x]==low[x]){
		int k;
		cnt++;
		do{
			k=stk[top--];
			vis[k]=0;
			be[k]=cnt;
		}while(k!=x);
	}
}
```